---
title: js闭包和内存释放
date: 2022-03-04 14:54:23
tags:
---
<div class="post-block"><link itemprop="mainEntityOfPage" href="http://cmszlx.win/2019/03/25/js闭包和内存释放/"><span hidden="" itemprop="author" itemscope="" itemtype="http://schema.org/Person"><meta itemprop="name" content="linXiao"><meta itemprop="description" content=""><meta itemprop="image" content="/images/avatar.gif"></span><span hidden="" itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization"><meta itemprop="name" content="Hurry"></span><header class="post-header"><h1 class="post-title" itemprop="name headline"></h1><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i></span><span class="post-meta-item-text">发表于</span><time title="创建于" itemprop="dateCreated datePublished" datetime="2019-03-25T17:14:53+08:00"> 2019年03月25日 </time></span></div></header><div class="post-body" itemprop="articleBody"><blockquote><p>闭包的那些事儿</p></blockquote><ul><li><p>怎么写一个闭包<br>闭包是什么就不解释了，直接写一个闭包函数：</p><precode language="" precodenum="0"></precode><p>js中，函数是一等公民，定义一个函数f，它返回另一个可执行函数`function() {</p><precode language="" precodenum="1"></precode><p> };`</p><p>js中的作用域，都是一层一层向上找的，在f内部函数里面，他的num向上找到父函数的作用域。<br>现在，我们执行一下：</p><precode language="" precodenum="2"></precode></li><li>内存回收机制<br>为什么上面执行结果不太对，因为执行<code>f()()</code>后，f函数已经执行完毕了，没有其他资源引用f，ta会被立即释放，也就是说，<code>f()()</code>执行完后，立即就释放了。<br>如何才不释放呢？</li></ul><precode language="" precodenum="3"></precode><p>这下就对了，num成了私有变量，f拥有了私有作用域。</p><p>完了吗？<br>f有了fn的引用，内存一直得不到释放，咋办呢？这样的函数多了是不是会造成内存溢出？<br>手动释放一下：</p><precode language="" precodenum="4"></precode></div><footer class="post-footer"><div class="post-tags"><a href="/tags/原创/" rel="tag"># 原创</a></div><div class="post-nav"><div class="post-nav-next post-nav-item"><a href="/2019/03/25/git目录中index-lock的作用以及它引发的报错/" rel="next" title=".git目录中index.lock的作用以及它引发的报错"><i class="fa fa-chevron-left"></i> .git目录中index.lock的作用以及它引发的报错 </a></div><span class="post-nav-divider"></span><div class="post-nav-prev post-nav-item"><a href="/2019/07/23/js手动实现自定义事件监听/" rel="prev" title="js 手动实现自定义事件监听"> js 手动实现自定义事件监听 <i class="fa fa-chevron-right"></i></a></div></div></footer></div>
